# 4.11.2 Тестування на виконання JavaScript

## ID
***WSTG-CLNT-02***

## Анотація

Ін'єкційна уразливість JavaScript  - це підтип міжсайтового скриптингу (XSS), який передбачає можливість впровадження довільного JavaScript коду, що виконується додатком у браузері жертви. Ця вразливість може мати багато наслідків, наприклад, розкриття сесійних файлів cookie користувача, які можуть бути використані для видачі себе за жертву, або, в більш загальному випадку, вона може дозволити зловмиснику змінити вміст сторінки, яку бачать жертви, або поведінку додатку.

Уразливість до ін'єкцій JavaScript може виникнути, якщо в додатку відсутня належна перевірка даних, що вводяться та виводяться користувачем. Оскільки JavaScript використовується для динамічного заповнення веб-сторінок, така ін'єкція відбувається на етапі обробки вмісту і, відповідно, впливає на жертву.

При тестуванні на цю уразливість слід враховувати, що деякі символи по-різному сприймаються різними браузерами. Для довідки [див. статтю DOM на основі XSS](https://owasp.org/www-community/attacks/DOM_Based_XSS).

Ось приклад скрипта, який не виконує ніякої перевірки змінної rr. Змінна містить дані, введені користувачем через рядок запиту, і додатково не застосовує жодного кодування:

```javascript
var rr = location.search.substring(1);
if(rr) {
    window.location=decodeURIComponent(rr);
}
```

Це означає, що зловмисник може впровадити JavaScript-код, просто відправивши наступний рядок запиту: `www.victim.com/?javascript:alert(1)`.

### Цілі тестування

- Виявлення вразливостей та можливих точок входу в систему JavaScript.

### Як тестувати

Зверніть увагу на наступне: [вправа DOM XSS](http://www.domxss.com/domxss/01_Basics/04_eval.html).

Сторінка містить наступний скрипт:

```javascript
<script>
function loadObj(){
    var cc=eval('('+aMess+')');
    document.getElementById('mess').textContent=cc.message;
}

if(window.location.hash.indexOf('message')==-1) {
    var aMess='({"message":"Hello User!"})';
} else {
    var aMess=location.hash.substr(window.location.hash.indexOf('message=')+8)
}
</script>
```

Вищенаведений код містить вихідний `location.hash`, який контролюється зловмисником, що може вставити JavaScript-код безпосередньо в значення `message`, щоб перехопити контроль над браузером користувача.
